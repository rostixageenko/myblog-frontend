<!DOCTYPE html>
<html lang="ru">
    <head>
        <meta charset="UTF-8" />
        <title>Новый пароль — MyBlog</title>
        <link rel="stylesheet" href="../css/reset_new_password.css " />
        <link rel="icon" href="../logo/head-logo.svg" type="image/png" />
    </head>
    <body>
        <div class="card">
            <h1>Новый пароль</h1>

            <form id="new-password-form">
                <label>Новый пароль</label>
                <div class="password-wrapper">
                    <input type="password" id="new-pass" class="input" />
                    <img
                        src="../icon/eye-open.svg"
                        id="toggle-password1"
                        class="eye-icon"
                        alt="Показать пароль"
                    />
                </div>

                <label>Повторите пароль</label>
                <div class="password-wrapper">
                    <input type="password" id="new-pass2" class="input" />
                    <img
                        src="../icon/eye-open.svg"
                        id="toggle-password2"
                        class="eye-icon"
                        alt="Показать пароль"
                    />
                </div>
                <button class="btn" type="submit">Сохранить пароль</button>
            </form>

            <div id="new-pass-msg" class="msg-box"></div>
        </div>

        <script src="../js/reset_new_password.js"></script>

        <script>
            document.addEventListener('DOMContentLoaded', () => {
                const maxLength = 50;

                const pass1 = document.getElementById('new-pass');
                const pass2 = document.getElementById('new-pass2');

                const inputs = [pass1, pass2];

                inputs.forEach((field) => {
                    field.addEventListener('input', () => {
                        if (/[А-Яа-яЁё]/g.test(field.value)) {
                            alert('Русские буквы запрещены!');
                            field.value = field.value.replace(
                                /[А-Яа-яЁё]/g,
                                ''
                            );
                            return;
                        }

                        if (/[^A-Za-z0-9]/g.test(field.value)) {
                            alert('Запрещены символы, кроме латиницы и цифр!');
                            field.value = field.value.replace(
                                /[^A-Za-z0-9]/g,
                                ''
                            );
                            return;
                        }

                        if (field.value.length > maxLength) {
                            alert(
                                'Превышено максимальное количество символов — 50'
                            );
                            field.value = field.value.slice(0, maxLength);
                        }
                    });
                });
            });

            document.addEventListener('DOMContentLoaded', () => {
                const passwordInput1 = document.getElementById('new-pass');
                const passwordInput2 = document.getElementById('new-pass2');
                const toggleIcon1 = document.getElementById('toggle-password1');
                const toggleIcon2 = document.getElementById('toggle-password2');

                if (
                    !passwordInput1 ||
                    !passwordInput2 ||
                    !toggleIcon1 ||
                    !toggleIcon2
                )
                    return;

                toggleIcon1.addEventListener('click', () => {
                    const isHidden = passwordInput1.type === 'password';

                    passwordInput1.type = isHidden ? 'text' : 'password';
                    toggleIcon1.src = isHidden
                        ? '../icon/eye-closed.svg'
                        : '../icon/eye-open.svg';
                });

                toggleIcon2.addEventListener('click', () => {
                    const isHidden = passwordInput2.type === 'password';

                    passwordInput2.type = isHidden ? 'text' : 'password';
                    toggleIcon2.src = isHidden
                        ? '../icon/eye-closed.png'
                        : '../icon/eye-open.svg';
                });
            });
        </script>
    </body>
</html>
